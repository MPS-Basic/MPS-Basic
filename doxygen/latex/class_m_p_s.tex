\doxysection{MPS Class Reference}
\hypertarget{class_m_p_s}{}\label{class_m_p_s}\index{MPS@{MPS}}


\doxylink{class_m_p_s}{MPS} simulation class.  




{\ttfamily \#include $<$mps.\+hpp$>$}



Collaboration diagram for MPS\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=337pt]{class_m_p_s__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_m_p_s_a3d24e435209ec65d3ddc7fed699580ac}{MPS}} ()=default
\item 
\mbox{\hyperlink{class_m_p_s_a719b1bab794263ab40d62df150f221d9}{MPS}} (const \mbox{\hyperlink{struct_input}{Input}} \&input)
\item 
void \mbox{\hyperlink{class_m_p_s_a82b98cfbec3d44a835a49e7cbf450c81}{init}} ()
\item 
void \mbox{\hyperlink{class_m_p_s_a14af7aa9a9b12e69573a345b6bd9e2fc}{step\+Forward}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{struct_settings}{Settings}} \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}
\begin{DoxyCompactList}\small\item\em \doxylink{struct_settings}{Settings} for the simulation. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_ref_values}{Ref\+Values}} \mbox{\hyperlink{class_m_p_s_a79c31492815a6099b360e963dafad6f6}{ref\+Values}}
\begin{DoxyCompactList}\small\item\em Reference values for the simulation ( $n^0$, $\lambda^0$) \end{DoxyCompactList}\item 
vector$<$ \mbox{\hyperlink{class_particle}{Particle}} $>$ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}
\begin{DoxyCompactList}\small\item\em Particles in the simulation. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_bucket}{Bucket}} \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}
\begin{DoxyCompactList}\small\item\em \doxylink{class_bucket}{Bucket} for neighbor search. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_domain}{Domain}} \mbox{\hyperlink{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}{domain}}
\begin{DoxyCompactList}\small\item\em \doxylink{class_domain}{Domain} of the simulation. \end{DoxyCompactList}\item 
Sparse\+Matrix$<$ double, Eigen\+::\+Row\+Major $>$ \mbox{\hyperlink{class_m_p_s_a76fc67a6aebaf6a9316ea1c1ad39e454}{coefficient\+Matrix}}
\begin{DoxyCompactList}\small\item\em Coefficient matrix for pressure Poisson equation. \end{DoxyCompactList}\item 
Vector\+Xd \mbox{\hyperlink{class_m_p_s_abe420b9a8ab12bce1ec40c77eb1fc56e}{source\+Term}}
\begin{DoxyCompactList}\small\item\em Source term for pressure Poisson equation. \end{DoxyCompactList}\item 
Vector\+Xd \mbox{\hyperlink{class_m_p_s_ae9ae97d3b9cc79fe5dc88aa1130a31d3}{pressure}}
\begin{DoxyCompactList}\small\item\em Solution of pressure Poisson equation. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{class_m_p_s_a3a67bb2944e7f0ae45e9431b0d7e781f}{courant}}
\begin{DoxyCompactList}\small\item\em Maximum courant number among all particles. \end{DoxyCompactList}\item 
FILE \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{class_m_p_s_a63fc7ef7401815d29f28b82c46e9b138}{log\+File}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_m_p_s_ae446ff4dfca3f3931ec03e40705030bc}{cal\+Gravity}} ()
\begin{DoxyCompactList}\small\item\em calculate gravity term \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a1aef09dfefb6bed3722f7fab70036020}{cal\+Viscosity}} (const double \&re)
\begin{DoxyCompactList}\small\item\em calculate viscosity term of Navier-\/\+Stokes equation \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a611ebb97cc77c13aada5bfd2e5cfad4c}{move\+Particle}} ()
\begin{DoxyCompactList}\small\item\em move particles in prediction step \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a9ef1206148404de5ddc7e1eaf84ce417}{collision}} ()
\begin{DoxyCompactList}\small\item\em calculate collision between particles when they are too close \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a453d54aac9444a03f4eb0e5669c47ecc}{cal\+Pressure}} ()
\begin{DoxyCompactList}\small\item\em calculate pressure using pressure Poisson equation \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_acb3466be30f7205c48777f22fd14b2f2}{cal\+Number\+Density}} (const double \&re)
\begin{DoxyCompactList}\small\item\em calculate number density of each particle \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a81e9cd20a573658ffcf48745c4ee9fb0}{set\+Boundary\+Condition}} ()
\begin{DoxyCompactList}\small\item\em set boundary condition of pressure Poisson equation \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_ac08551eabe3b8f90a3bae8b036e028ca}{set\+Source\+Term}} ()
\begin{DoxyCompactList}\small\item\em set source term of pressure Poisson equation \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_ad5bb5f20c065ff76079498324156ecca}{set\+Matrix}} (const double \&re)
\begin{DoxyCompactList}\small\item\em set coefficient matrix of pressure Poisson equation \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a595cb40d0d0559775c32e2ce4578a755}{exceptional\+Processing\+For\+Boundary\+Condition}} ()
\item 
void \mbox{\hyperlink{class_m_p_s_a70a3fe360f32d958a94bf0f4ee771e23}{solve\+Simultaneous\+Equations}} ()
\begin{DoxyCompactList}\small\item\em Solve the pressure Poisson equation. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a94e40c9d47fababe9746085209882b98}{remove\+Negative\+Pressure}} ()
\begin{DoxyCompactList}\small\item\em remove negative pressure for stability \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a11655a6dd010f2aafb7fbadec69a7bd8}{set\+Minimum\+Pressure}} (const double \&re)
\begin{DoxyCompactList}\small\item\em set minimum pressure for pressure gradient calculation \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a3cfe127146bc99fa5c01aa7645435532}{cal\+Pressure\+Gradient}} (const double \&re)
\begin{DoxyCompactList}\small\item\em calculate pressure gradient term \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a2c84df62724f22dd2d3f2379ae0c7238}{move\+Particle\+Using\+Pressure\+Gradient}} ()
\begin{DoxyCompactList}\small\item\em move particles in correction step \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_a9c368cb50383581f4eef311bca1c513a}{cal\+Courant}} ()
\begin{DoxyCompactList}\small\item\em calculate Courant number \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_p_s_aebc09c85dee628318c4b756f5bd5a5fb}{set\+Neighbors}} (const double \&re)
\begin{DoxyCompactList}\small\item\em search neighbors of each particle \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\doxylink{class_m_p_s}{MPS} simulation class. 

Executes the \doxylink{class_m_p_s}{MPS} simulation. This class does not handle the simulation process itself, but only the calculation of the \doxylink{class_m_p_s}{MPS} method. 

Definition at line \mbox{\hyperlink{mps_8hpp_source_l00036}{36}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_m_p_s_a3d24e435209ec65d3ddc7fed699580ac}\label{class_m_p_s_a3d24e435209ec65d3ddc7fed699580ac} 
\index{MPS@{MPS}!MPS@{MPS}}
\index{MPS@{MPS}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{MPS()}{MPS()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily MPS\+::\+MPS (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}

\Hypertarget{class_m_p_s_a719b1bab794263ab40d62df150f221d9}\label{class_m_p_s_a719b1bab794263ab40d62df150f221d9} 
\index{MPS@{MPS}!MPS@{MPS}}
\index{MPS@{MPS}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{MPS()}{MPS()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily MPS\+::\+MPS (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_input}{Input}} \&}]{input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00054}{54}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}\ \ =\ input.\mbox{\hyperlink{struct_input_a543f51c76db7bc78db6385830fb49448}{settings}};}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}{domain}}\ \ \ \ =\ input.\mbox{\hyperlink{struct_input_a543f51c76db7bc78db6385830fb49448}{settings}}.\mbox{\hyperlink{struct_settings_af3cd0d5dc8ca911ece86b0df7deed350}{domain}};}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}\ =\ input.\mbox{\hyperlink{struct_input_aa1e111753c0ef8b7f3c31504f4cded79}{particles}};}
\DoxyCodeLine{00058\ \ \ \ \ \};}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{class_m_p_s_a82b98cfbec3d44a835a49e7cbf450c81}\label{class_m_p_s_a82b98cfbec3d44a835a49e7cbf450c81} 
\index{MPS@{MPS}!init@{init}}
\index{init@{init}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{init()}{init()}}
{\footnotesize\ttfamily void MPS\+::init (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00060}{60}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a79c31492815a6099b360e963dafad6f6}{refValues}}.\mbox{\hyperlink{class_ref_values_a71d30fdbb911bdb22bd844234af42cfd}{calc}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a7ccc3a993adfd0dd8686cf2a5e0052fa}{dim}},\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a4efbd869c69cf91f5a620eb777fce8f7}{particleDistance}},\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a80732a572412e5d0ccd1177f66036b85}{re\_forNumberDensity}},\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_addf081560df074610e6de84a03169cd3}{re\_forGradient}},}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_afc3f6210bad35eff814ffd21753c96da}{re\_forLaplacian}});}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_a814966faf6c36767fe6b08ab0441715e}{set}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a11a8ac570c6863ef348dcb9180c80f3c}{reMax}},\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ab2f4295ff4eedc87307496f037ae30c1}{cflCondition}},\ \mbox{\hyperlink{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}{domain}},\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}.size());}
\DoxyCodeLine{00064\ \ \ \ \ \};}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=337pt]{class_m_p_s_a82b98cfbec3d44a835a49e7cbf450c81_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=327pt]{class_m_p_s_a82b98cfbec3d44a835a49e7cbf450c81_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a14af7aa9a9b12e69573a345b6bd9e2fc}\label{class_m_p_s_a14af7aa9a9b12e69573a345b6bd9e2fc} 
\index{MPS@{MPS}!stepForward@{stepForward}}
\index{stepForward@{stepForward}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{stepForward()}{stepForward()}}
{\footnotesize\ttfamily void MPS\+::step\+Forward (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00066}{66}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_aee5671d48e069137954edfccc0611b80}{storeParticles}}(\mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}},\ \mbox{\hyperlink{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}{domain}});}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_aebc09c85dee628318c4b756f5bd5a5fb}{setNeighbors}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a11a8ac570c6863ef348dcb9180c80f3c}{reMax}});}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_ae446ff4dfca3f3931ec03e40705030bc}{calGravity}}();}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a1aef09dfefb6bed3722f7fab70036020}{calViscosity}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_afc3f6210bad35eff814ffd21753c96da}{re\_forLaplacian}});}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a611ebb97cc77c13aada5bfd2e5cfad4c}{moveParticle}}();}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_aee5671d48e069137954edfccc0611b80}{storeParticles}}(\mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}},\ \mbox{\hyperlink{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}{domain}});}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_aebc09c85dee628318c4b756f5bd5a5fb}{setNeighbors}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a11a8ac570c6863ef348dcb9180c80f3c}{reMax}});}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a9ef1206148404de5ddc7e1eaf84ce417}{collision}}();}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_aee5671d48e069137954edfccc0611b80}{storeParticles}}(\mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}},\ \mbox{\hyperlink{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}{domain}});}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_aebc09c85dee628318c4b756f5bd5a5fb}{setNeighbors}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a11a8ac570c6863ef348dcb9180c80f3c}{reMax}});}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a453d54aac9444a03f4eb0e5669c47ecc}{calPressure}}();}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a3cfe127146bc99fa5c01aa7645435532}{calPressureGradient}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_addf081560df074610e6de84a03169cd3}{re\_forGradient}});}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a2c84df62724f22dd2d3f2379ae0c7238}{moveParticleUsingPressureGradient}}();}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a9c368cb50383581f4eef311bca1c513a}{calCourant}}();}
\DoxyCodeLine{00084\ \ \ \ \ \};}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a14af7aa9a9b12e69573a345b6bd9e2fc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a14af7aa9a9b12e69573a345b6bd9e2fc_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_ae446ff4dfca3f3931ec03e40705030bc}\label{class_m_p_s_ae446ff4dfca3f3931ec03e40705030bc} 
\index{MPS@{MPS}!calGravity@{calGravity}}
\index{calGravity@{calGravity}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{calGravity()}{calGravity()}}
{\footnotesize\ttfamily void MPS\+::cal\+Gravity (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



calculate gravity term 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00090}{90}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00091\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ p\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.type\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6ac2e7db5ac7ab74ea4bb9a7a89d251f3a}{ParticleType::Fluid}})\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.acceleration\ +=\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a03e5a92fc8bfe8a22f6a8fc22099463d}{gravity}};}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.acceleration.setZero();}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00100\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_ae446ff4dfca3f3931ec03e40705030bc_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a1aef09dfefb6bed3722f7fab70036020}\label{class_m_p_s_a1aef09dfefb6bed3722f7fab70036020} 
\index{MPS@{MPS}!calViscosity@{calViscosity}}
\index{calViscosity@{calViscosity}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{calViscosity()}{calViscosity()}}
{\footnotesize\ttfamily void MPS\+::cal\+Viscosity (\begin{DoxyParamCaption}\item[{const double \&}]{re }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



calculate viscosity term of Navier-\/\+Stokes equation 


\begin{DoxyParams}{Parameters}
{\em re} & effective radius $r_e$\\
\hline
\end{DoxyParams}
The viscosity term of the Navier-\/\+Stokes equation is calculated as follows\+:  \[
\nu\langle \nabla^2\mathbf{u}\rangle_i = \nu\frac{2 d}{n^0\lambda^0}\sum_{j\neq i} (\mathbf{u}_j - \mathbf{u}_i)
w_{ij} \] 

Definition at line \mbox{\hyperlink{mps_8hpp_source_l00111}{111}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ n0\ \ \ \ \ =\ \mbox{\hyperlink{class_m_p_s_a79c31492815a6099b360e963dafad6f6}{refValues}}.\mbox{\hyperlink{class_ref_values_a8b0c882e85501a6438d7194bdc2a3468}{n0\_forLaplacian}};}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ lambda\ =\ \mbox{\hyperlink{class_m_p_s_a79c31492815a6099b360e963dafad6f6}{refValues}}.\mbox{\hyperlink{class_ref_values_ac7064084b5d2783113d0f15f998af0ab}{lambda}};}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ a\ \ \ \ \ \ =\ (\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_aafe442716f18b5255f60461e424318f4}{kinematicViscosity}})\ *\ (2.0\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a7ccc3a993adfd0dd8686cf2a5e0052fa}{dim}})\ /\ (n0\ *\ lambda);}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.type\ !=\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6ac2e7db5ac7ab74ea4bb9a7a89d251f3a}{ParticleType::Fluid}})}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::Vector3d\ viscosityTerm\ =\ Eigen::Vector3d::Zero();}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ neighbor\ :\ pi.neighbors)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ pj\ =\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}[neighbor.id];}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (neighbor.distance\ <\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_afc3f6210bad35eff814ffd21753c96da}{re\_forLaplacian}})\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ w\ =\ \mbox{\hyperlink{weight_8hpp_aff5c38d6ca294d8c3338e6dd617b5f7b}{weight}}(neighbor.distance,\ re);}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ viscosityTerm\ +=\ (pj.velocity\ -\/\ pi.velocity)\ *\ w;}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ viscosityTerm\ *=\ a;}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ pi.acceleration\ +=\ viscosityTerm;}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00135\ \ \ \ \ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{class_m_p_s_a1aef09dfefb6bed3722f7fab70036020_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a1aef09dfefb6bed3722f7fab70036020_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a611ebb97cc77c13aada5bfd2e5cfad4c}\label{class_m_p_s_a611ebb97cc77c13aada5bfd2e5cfad4c} 
\index{MPS@{MPS}!moveParticle@{moveParticle}}
\index{moveParticle@{moveParticle}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{moveParticle()}{moveParticle()}}
{\footnotesize\ttfamily void MPS\+::move\+Particle (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



move particles in prediction step 

The position and velocity of each particle are updated as  \[
\mathbf{u}_i^* = \mathbf{u}_i^k + (\nu\langle \nabla^2\mathbf{u}\rangle^k_i+\mathbf{g})\Delta t.
\] 

Definition at line \mbox{\hyperlink{mps_8hpp_source_l00144}{144}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ p\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.type\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6ac2e7db5ac7ab74ea4bb9a7a89d251f3a}{ParticleType::Fluid}})\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.velocity\ +=\ p.acceleration\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}};}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.position\ +=\ p.velocity\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}};}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.acceleration.setZero();}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00155\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a611ebb97cc77c13aada5bfd2e5cfad4c_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a9ef1206148404de5ddc7e1eaf84ce417}\label{class_m_p_s_a9ef1206148404de5ddc7e1eaf84ce417} 
\index{MPS@{MPS}!collision@{collision}}
\index{collision@{collision}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{collision()}{collision()}}
{\footnotesize\ttfamily void MPS\+::collision (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



calculate collision between particles when they are too close 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00160}{160}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.type\ !=\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6ac2e7db5ac7ab74ea4bb9a7a89d251f3a}{ParticleType::Fluid}})}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ neighbor\ :\ pi.neighbors)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_particle}{Particle}}\&\ pj\ =\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}[neighbor.id];}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pj.\mbox{\hyperlink{class_particle_abd8b570239b18eb394b692834b5b4453}{type}}\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6ac2e7db5ac7ab74ea4bb9a7a89d251f3a}{ParticleType::Fluid}}\ \&\&\ pj.\mbox{\hyperlink{class_particle_a544b202775517f8ba05efcb9e0a21bee}{id}}\ >=\ pi.id)}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (neighbor.distance\ <\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a3c43fb080366e4ed27dd5f5c2577ce68}{collisionDistance}})\ \{}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ invMi\ =\ pi.inverseDensity(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a82533e4fd56cc3a975b8c0de3b4861c8}{fluidDensity}});}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ invMj\ =\ pj.\mbox{\hyperlink{class_particle_aaf04b310f05eb587bb2ab2f2cb155783}{inverseDensity}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a82533e4fd56cc3a975b8c0de3b4861c8}{fluidDensity}});}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ mass\ \ =\ 1.0\ /\ (invMi\ +\ invMj);}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::Vector3d\ normal\ =\ (pj.\mbox{\hyperlink{class_particle_a302f050b0320dcc4b580d08131d8781b}{position}}\ -\/\ pi.position).normalized();}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ relVel\ \ \ \ \ \ \ \ \ \ =\ (pj.\mbox{\hyperlink{class_particle_ababe1f4b7ea49c3a197c62b44b61a2b6}{velocity}}\ -\/\ pi.velocity).dot(normal);}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ impulse\ \ \ \ \ \ \ \ \ =\ 0.0;}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (relVel\ <\ 0.0)}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ impulse\ =\ -\/(1\ +\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_abd1a0a50ce3901dd2a2c9921fd87bd49}{coefficientOfRestitution}})\ *\ relVel\ *\ mass;}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pi.velocity\ -\/=\ impulse\ *\ invMi\ *\ normal;}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pj.\mbox{\hyperlink{class_particle_ababe1f4b7ea49c3a197c62b44b61a2b6}{velocity}}\ +=\ impulse\ *\ invMj\ *\ normal;}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ depth\ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a3c43fb080366e4ed27dd5f5c2577ce68}{collisionDistance}}\ -\/\ neighbor.distance;}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ positionImpulse\ =\ depth\ *\ mass;}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pi.position\ -\/=\ positionImpulse\ *\ invMi\ *\ normal;}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pj.\mbox{\hyperlink{class_particle_a302f050b0320dcc4b580d08131d8781b}{position}}\ +=\ positionImpulse\ *\ invMj\ *\ normal;}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::cerr\ <<\ "{}WARNING:\ Collision\ between\ particles\ "{}\ <<\ pi.id\ <<\ "{}\ and\ "{}\ <<\ pj.id\ <<\ "{}\ occurred."{}}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ <<\ std::endl;}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00194\ \ \ \ \ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{class_m_p_s_a9ef1206148404de5ddc7e1eaf84ce417_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a9ef1206148404de5ddc7e1eaf84ce417_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a453d54aac9444a03f4eb0e5669c47ecc}\label{class_m_p_s_a453d54aac9444a03f4eb0e5669c47ecc} 
\index{MPS@{MPS}!calPressure@{calPressure}}
\index{calPressure@{calPressure}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{calPressure()}{calPressure()}}
{\footnotesize\ttfamily void MPS\+::cal\+Pressure (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



calculate pressure using pressure Poisson equation 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00199}{199}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_acb3466be30f7205c48777f22fd14b2f2}{calNumberDensity}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a80732a572412e5d0ccd1177f66036b85}{re\_forNumberDensity}});}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a81e9cd20a573658ffcf48745c4ee9fb0}{setBoundaryCondition}}();}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_ac08551eabe3b8f90a3bae8b036e028ca}{setSourceTerm}}();}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_ad5bb5f20c065ff76079498324156ecca}{setMatrix}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_afc3f6210bad35eff814ffd21753c96da}{re\_forLaplacian}});}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a70a3fe360f32d958a94bf0f4ee771e23}{solveSimultaneousEquations}}();}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a94e40c9d47fababe9746085209882b98}{removeNegativePressure}}();}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a11655a6dd010f2aafb7fbadec69a7bd8}{setMinimumPressure}}(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_addf081560df074610e6de84a03169cd3}{re\_forGradient}});}
\DoxyCodeLine{00207\ \ \ \ \ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a453d54aac9444a03f4eb0e5669c47ecc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a453d54aac9444a03f4eb0e5669c47ecc_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_acb3466be30f7205c48777f22fd14b2f2}\label{class_m_p_s_acb3466be30f7205c48777f22fd14b2f2} 
\index{MPS@{MPS}!calNumberDensity@{calNumberDensity}}
\index{calNumberDensity@{calNumberDensity}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{calNumberDensity()}{calNumberDensity()}}
{\footnotesize\ttfamily void MPS\+::cal\+Number\+Density (\begin{DoxyParamCaption}\item[{const double \&}]{re }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



calculate number density of each particle 


\begin{DoxyParams}{Parameters}
{\em re} & effective radius $r_e$ \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{mps_8hpp_source_l00213}{213}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00214\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ pi.numberDensity\ =\ 0.0;}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.type\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a401357e57c765967393ba391a338e89b}{ParticleType::Ghost}})}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ neighbor\ :\ pi.neighbors)}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pi.numberDensity\ +=\ \mbox{\hyperlink{weight_8hpp_aff5c38d6ca294d8c3338e6dd617b5f7b}{weight}}(neighbor.distance,\ re);}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00224\ \ \ \ \ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=283pt]{class_m_p_s_acb3466be30f7205c48777f22fd14b2f2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_acb3466be30f7205c48777f22fd14b2f2_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a81e9cd20a573658ffcf48745c4ee9fb0}\label{class_m_p_s_a81e9cd20a573658ffcf48745c4ee9fb0} 
\index{MPS@{MPS}!setBoundaryCondition@{setBoundaryCondition}}
\index{setBoundaryCondition@{setBoundaryCondition}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{setBoundaryCondition()}{setBoundaryCondition()}}
{\footnotesize\ttfamily void MPS\+::set\+Boundary\+Condition (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



set boundary condition of pressure Poisson equation 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00228}{228}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ n0\ \ \ =\ \mbox{\hyperlink{class_m_p_s_a79c31492815a6099b360e963dafad6f6}{refValues}}.\mbox{\hyperlink{class_ref_values_a099cb5378fb6efa0f6e6c23ad717bb3c}{n0\_forNumberDensity}};}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ beta\ =\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a1bc155804e2a1199dd25300a587e1264}{surfaceDetectionRatio}};}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.type\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a401357e57c765967393ba391a338e89b}{ParticleType::Ghost}}\ ||\ pi.type\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a9da8991e93d730874cddc8c250e09196}{ParticleType::DummyWall}})\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pi.boundaryCondition\ =\ \mbox{\hyperlink{particle_8hpp_a4de979302c7bfe449e0ebca28023f791ad96143ba1b15645919cea00ec9d1be62}{FluidState::Ignored}};}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (pi.numberDensity\ <\ beta\ *\ n0)\ \{}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pi.boundaryCondition\ =\ \mbox{\hyperlink{particle_8hpp_a4de979302c7bfe449e0ebca28023f791ac55ccf367c0ba696739520ab137a1ce1}{FluidState::FreeSurface}};}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pi.boundaryCondition\ =\ \mbox{\hyperlink{particle_8hpp_a4de979302c7bfe449e0ebca28023f791aa1684698ac3d8ffda353d0458c30b1e7}{FluidState::Inner}};}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a81e9cd20a573658ffcf48745c4ee9fb0_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_ac08551eabe3b8f90a3bae8b036e028ca}\label{class_m_p_s_ac08551eabe3b8f90a3bae8b036e028ca} 
\index{MPS@{MPS}!setSourceTerm@{setSourceTerm}}
\index{setSourceTerm@{setSourceTerm}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{setSourceTerm()}{setSourceTerm()}}
{\footnotesize\ttfamily void MPS\+::set\+Source\+Term (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



set source term of pressure Poisson equation 

The source term of the pressure Poisson equation is calculated as follows\+:  \[
b_i = \frac{\gamma}{\Delta t^2}\frac{n_i-n^0}{n^0}
\] 

Definition at line \mbox{\hyperlink{mps_8hpp_source_l00254}{254}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ n0\ \ \ \ =\ \mbox{\hyperlink{class_m_p_s_a79c31492815a6099b360e963dafad6f6}{refValues}}.\mbox{\hyperlink{class_ref_values_a099cb5378fb6efa0f6e6c23ad717bb3c}{n0\_forNumberDensity}};}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ gamma\ =\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a7f273ed7d24bea05e579638d81c05705}{relaxationCoefficientForPressure}};}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ pi.sourceTerm\ =\ 0.0;}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.boundaryCondition\ ==\ \mbox{\hyperlink{particle_8hpp_a4de979302c7bfe449e0ebca28023f791aa1684698ac3d8ffda353d0458c30b1e7}{FluidState::Inner}})\ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pi.sourceTerm\ =\ gamma\ *\ (1.0\ /\ (\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}}\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}}))\ *\ ((pi.numberDensity\ -\/\ n0)\ /\ n0);}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00265\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_ac08551eabe3b8f90a3bae8b036e028ca_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_ad5bb5f20c065ff76079498324156ecca}\label{class_m_p_s_ad5bb5f20c065ff76079498324156ecca} 
\index{MPS@{MPS}!setMatrix@{setMatrix}}
\index{setMatrix@{setMatrix}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{setMatrix()}{setMatrix()}}
{\footnotesize\ttfamily void MPS\+::set\+Matrix (\begin{DoxyParamCaption}\item[{const double \&}]{re }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



set coefficient matrix of pressure Poisson equation 


\begin{DoxyParams}{Parameters}
{\em re} & effective radius $r_e$\\
\hline
\end{DoxyParams}
Applying Laplacian model to pressure Poisson equation, the coefficient matrix is calculated as follows\+:  \[
 -\frac{1}{\rho^0}\langle\nabla^2 P\rangle_i^{k+1} = b_i.
\] 

Definition at line \mbox{\hyperlink{mps_8hpp_source_l00275}{275}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ std::vector<Eigen::Triplet<double>>\ triplets;}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ n0\ =\ \mbox{\hyperlink{class_m_p_s_a79c31492815a6099b360e963dafad6f6}{refValues}}.\mbox{\hyperlink{class_ref_values_a8b0c882e85501a6438d7194bdc2a3468}{n0\_forLaplacian}};}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ a\ \ =\ 2.0\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a7ccc3a993adfd0dd8686cf2a5e0052fa}{dim}}\ /\ (n0\ *\ \mbox{\hyperlink{class_m_p_s_a79c31492815a6099b360e963dafad6f6}{refValues}}.\mbox{\hyperlink{class_ref_values_ac7064084b5d2783113d0f15f998af0ab}{lambda}});}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a76fc67a6aebaf6a9316ea1c1ad39e454}{coefficientMatrix}}.resize(\mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}.size(),\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}.size());}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.boundaryCondition\ !=\ \mbox{\hyperlink{particle_8hpp_a4de979302c7bfe449e0ebca28023f791aa1684698ac3d8ffda353d0458c30b1e7}{FluidState::Inner}})}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ coefficient\_ii\ =\ 0.0;}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ neighbor\ :\ pi.neighbors)\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_particle}{Particle}}\&\ pj\ =\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}[neighbor.id];}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pj.\mbox{\hyperlink{class_particle_a07bf046a3f40091141a6812f4a144732}{boundaryCondition}}\ ==\ \mbox{\hyperlink{particle_8hpp_a4de979302c7bfe449e0ebca28023f791ad96143ba1b15645919cea00ec9d1be62}{FluidState::Ignored}})}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (neighbor.distance\ <\ re)\ \{}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ coefficient\_ij\ =\ a\ *\ \mbox{\hyperlink{weight_8hpp_aff5c38d6ca294d8c3338e6dd617b5f7b}{weight}}(neighbor.distance,\ re)\ /\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a82533e4fd56cc3a975b8c0de3b4861c8}{fluidDensity}};}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ triplets.emplace\_back(pi.id,\ pj.\mbox{\hyperlink{class_particle_a544b202775517f8ba05efcb9e0a21bee}{id}},\ -\/1.0\ *\ coefficient\_ij);}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coefficient\_ii\ +=\ coefficient\_ij;}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ coefficient\_ii\ +=\ (\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a365f66cf0f2979b8de21a62487efbefd}{compressibility}})\ /\ (\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}}\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}});}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ triplets.emplace\_back(pi.id,\ pi.id,\ coefficient\_ii);}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a76fc67a6aebaf6a9316ea1c1ad39e454}{coefficientMatrix}}.setFromTriplets(triplets.begin(),\ triplets.end());}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ exceptionalProcessingForBoundaryCondition();}}
\DoxyCodeLine{00303\ \ \ \ \ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{class_m_p_s_ad5bb5f20c065ff76079498324156ecca_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_ad5bb5f20c065ff76079498324156ecca_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a595cb40d0d0559775c32e2ce4578a755}\label{class_m_p_s_a595cb40d0d0559775c32e2ce4578a755} 
\index{MPS@{MPS}!exceptionalProcessingForBoundaryCondition@{exceptionalProcessingForBoundaryCondition}}
\index{exceptionalProcessingForBoundaryCondition@{exceptionalProcessingForBoundaryCondition}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{exceptionalProcessingForBoundaryCondition()}{exceptionalProcessingForBoundaryCondition()}}
{\footnotesize\ttfamily void MPS\+::exceptional\+Processing\+For\+Boundary\+Condition (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00305}{305}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ If\ there\ is\ no\ Dirichlet\ boundary\ condition\ on\ the\ fluid, }}
\DoxyCodeLine{00307\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ increase\ the\ diagonal\ terms\ of\ the\ matrix\ for\ an\ exception.\ This }}
\DoxyCodeLine{00308\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ allows\ us\ to\ solve\ the\ matrix\ without\ Dirichlet\ boundary\ conditions. }}
\DoxyCodeLine{00309\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ std::vector<bool>\ checked(\mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ std::vector<bool>\ connected(\mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.boundaryCondition\ ==\ \mbox{\hyperlink{particle_8hpp_a4de979302c7bfe449e0ebca28023f791ac55ccf367c0ba696739520ab137a1ce1}{FluidState::FreeSurface}})}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connected[pi.id]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (connected[pi.id])}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ BFS\ for\ connected\ components}}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ std::queue<size\_t>\ queue;}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ queue.push(pi.id);}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ checked[pi.id]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (!queue.empty())\ \{}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ pop\ front\ element}}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ v\ =\ queue.front();}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ queue.pop();}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ search\ for\ adjacent\ nodes}}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (Eigen::SparseMatrix<double,\ Eigen::RowMajor>::InnerIterator\ it(\mbox{\hyperlink{class_m_p_s_a76fc67a6aebaf6a9316ea1c1ad39e454}{coefficientMatrix}},\ v);\ it;\ ++it)\ \{}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ nv\ =\ it.col();}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!checked[nv])\ \{}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (connected[nv])\ \{\ \textcolor{comment}{//\ connected\ to\ boundary}}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connected[v]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checked[v]\ \ \ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ queue.push(nv);}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checked[nv]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00343\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{class_m_p_s_a70a3fe360f32d958a94bf0f4ee771e23}\label{class_m_p_s_a70a3fe360f32d958a94bf0f4ee771e23} 
\index{MPS@{MPS}!solveSimultaneousEquations@{solveSimultaneousEquations}}
\index{solveSimultaneousEquations@{solveSimultaneousEquations}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{solveSimultaneousEquations()}{solveSimultaneousEquations()}}
{\footnotesize\ttfamily void MPS\+::solve\+Simultaneous\+Equations (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Solve the pressure Poisson equation. 

The pressure Poisson equation is solved using the Bi\+CGSTAB method. 

Definition at line \mbox{\hyperlink{mps_8hpp_source_l00349}{349}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_abe420b9a8ab12bce1ec40c77eb1fc56e}{sourceTerm}}.resize(\mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}.size());}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_ae9ae97d3b9cc79fe5dc88aa1130a31d3}{pressure}}.resize(\mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}.size());}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_abe420b9a8ab12bce1ec40c77eb1fc56e}{sourceTerm}}[pi.id]\ =\ pi.sourceTerm;}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ Eigen::BiCGSTAB<Eigen::SparseMatrix<double,\ Eigen::RowMajor>>\ solver;}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ solver.compute(\mbox{\hyperlink{class_m_p_s_a76fc67a6aebaf6a9316ea1c1ad39e454}{coefficientMatrix}});}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_ae9ae97d3b9cc79fe5dc88aa1130a31d3}{pressure}}\ =\ solver.solve(\mbox{\hyperlink{class_m_p_s_abe420b9a8ab12bce1ec40c77eb1fc56e}{sourceTerm}});}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (solver.info()\ !=\ Eigen::Success)\ \{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}Pressure\ calculation\ failed."{}}\ <<\ std::endl;}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ std::exit(-\/1);}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ pi.pressure\ =\ \mbox{\hyperlink{class_m_p_s_ae9ae97d3b9cc79fe5dc88aa1130a31d3}{pressure}}[pi.id];}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00370\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a70a3fe360f32d958a94bf0f4ee771e23_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a94e40c9d47fababe9746085209882b98}\label{class_m_p_s_a94e40c9d47fababe9746085209882b98} 
\index{MPS@{MPS}!removeNegativePressure@{removeNegativePressure}}
\index{removeNegativePressure@{removeNegativePressure}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{removeNegativePressure()}{removeNegativePressure()}}
{\footnotesize\ttfamily void MPS\+::remove\+Negative\+Pressure (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



remove negative pressure for stability 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00374}{374}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00375\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ p\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.pressure\ <\ 0.0)\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.pressure\ =\ 0.0;}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00381\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a94e40c9d47fababe9746085209882b98_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a11655a6dd010f2aafb7fbadec69a7bd8}\label{class_m_p_s_a11655a6dd010f2aafb7fbadec69a7bd8} 
\index{MPS@{MPS}!setMinimumPressure@{setMinimumPressure}}
\index{setMinimumPressure@{setMinimumPressure}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{setMinimumPressure()}{setMinimumPressure()}}
{\footnotesize\ttfamily void MPS\+::set\+Minimum\+Pressure (\begin{DoxyParamCaption}\item[{const double \&}]{re }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



set minimum pressure for pressure gradient calculation 


\begin{DoxyParams}{Parameters}
{\em re} & effective radius $r_e$ \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{mps_8hpp_source_l00386}{386}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00387\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ p\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ p.minimumPressure\ =\ p.pressure;}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.type\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a401357e57c765967393ba391a338e89b}{ParticleType::Ghost}}\ ||\ pi.type\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a9da8991e93d730874cddc8c250e09196}{ParticleType::DummyWall}})}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ neighbor\ :\ pi.neighbors)\ \{}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_particle}{Particle}}\&\ pj\ =\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}[neighbor.id];}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pj.\mbox{\hyperlink{class_particle_abd8b570239b18eb394b692834b5b4453}{type}}\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a401357e57c765967393ba391a338e89b}{ParticleType::Ghost}}\ ||\ pj.\mbox{\hyperlink{class_particle_abd8b570239b18eb394b692834b5b4453}{type}}\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a9da8991e93d730874cddc8c250e09196}{ParticleType::DummyWall}})}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pj.\mbox{\hyperlink{class_particle_a544b202775517f8ba05efcb9e0a21bee}{id}}\ >\ pi.id)}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (neighbor.distance\ <\ re)\ \{}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pi.minimumPressure\ =\ std::min(pi.minimumPressure,\ pj.\mbox{\hyperlink{class_particle_a39e27ebf8bbfd348252b89e1c4db3b92}{pressure}});}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pj.\mbox{\hyperlink{class_particle_ab63c4b7ac8641d36b68aded7a1fe2953}{minimumPressure}}\ =\ std::min(pj.\mbox{\hyperlink{class_particle_ab63c4b7ac8641d36b68aded7a1fe2953}{minimumPressure}},\ pi.pressure);}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00409\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a11655a6dd010f2aafb7fbadec69a7bd8_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a3cfe127146bc99fa5c01aa7645435532}\label{class_m_p_s_a3cfe127146bc99fa5c01aa7645435532} 
\index{MPS@{MPS}!calPressureGradient@{calPressureGradient}}
\index{calPressureGradient@{calPressureGradient}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{calPressureGradient()}{calPressureGradient()}}
{\footnotesize\ttfamily void MPS\+::cal\+Pressure\+Gradient (\begin{DoxyParamCaption}\item[{const double \&}]{re }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



calculate pressure gradient term 


\begin{DoxyParams}{Parameters}
{\em re} & \\
\hline
\end{DoxyParams}
The pressure gradient term of the Navier-\/\+Stokes equation is calculated as  \[
-\frac{1}{\rho^0}\langle\nabla P\rangle_i = -\frac{1}{\rho^0}\frac{d}{n^0}\sum_{j\neq i}
\frac{P_j-P\textnormal{\textquotesingle}_i}{\|\mathbf{r}_{ij}\|^2}\mathbf{r}_{ij} w_{ij} \] where $P\textnormal{\textquotesingle}_i$ is the minimum pressure of the particle $i$. 

Definition at line \mbox{\hyperlink{mps_8hpp_source_l00420}{420}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ a\ =\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a7ccc3a993adfd0dd8686cf2a5e0052fa}{dim}}\ /\ \mbox{\hyperlink{class_m_p_s_a79c31492815a6099b360e963dafad6f6}{refValues}}.\mbox{\hyperlink{class_ref_values_a9fa89ba33f4391ca6448cd749612a0d7}{n0\_forGradient}};}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.type\ !=\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6ac2e7db5ac7ab74ea4bb9a7a89d251f3a}{ParticleType::Fluid}})}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::Vector3d\ grad\ =\ Eigen::Vector3d::Zero();}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ neighbor\ :\ pi.neighbors)\ \{}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_particle}{Particle}}\&\ pj\ =\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}[neighbor.id];}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pj.\mbox{\hyperlink{class_particle_abd8b570239b18eb394b692834b5b4453}{type}}\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a401357e57c765967393ba391a338e89b}{ParticleType::Ghost}}\ ||\ pj.\mbox{\hyperlink{class_particle_abd8b570239b18eb394b692834b5b4453}{type}}\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a9da8991e93d730874cddc8c250e09196}{ParticleType::DummyWall}})}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (neighbor.distance\ <\ re)\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ w\ =\ \mbox{\hyperlink{weight_8hpp_aff5c38d6ca294d8c3338e6dd617b5f7b}{weight}}(neighbor.distance,\ re);}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ double\ dist2\ =\ pow(neighbor.distance,\ 2);}}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dist2\ =\ (pj.\mbox{\hyperlink{class_particle_a302f050b0320dcc4b580d08131d8781b}{position}}\ -\/\ pi.position).squaredNorm();}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ pij\ \ \ =\ (pj.\mbox{\hyperlink{class_particle_a39e27ebf8bbfd348252b89e1c4db3b92}{pressure}}\ -\/\ pi.minimumPressure)\ /\ dist2;}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ grad\ +=\ (pj.\mbox{\hyperlink{class_particle_a302f050b0320dcc4b580d08131d8781b}{position}}\ -\/\ pi.position)\ *\ pij\ *\ w;}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ grad\ *=\ a;}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ pi.acceleration\ -\/=\ grad\ *\ pi.inverseDensity(\mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a82533e4fd56cc3a975b8c0de3b4861c8}{fluidDensity}});}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00445\ \ \ \ \ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=292pt]{class_m_p_s_a3cfe127146bc99fa5c01aa7645435532_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a3cfe127146bc99fa5c01aa7645435532_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a2c84df62724f22dd2d3f2379ae0c7238}\label{class_m_p_s_a2c84df62724f22dd2d3f2379ae0c7238} 
\index{MPS@{MPS}!moveParticleUsingPressureGradient@{moveParticleUsingPressureGradient}}
\index{moveParticleUsingPressureGradient@{moveParticleUsingPressureGradient}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{moveParticleUsingPressureGradient()}{moveParticleUsingPressureGradient()}}
{\footnotesize\ttfamily void MPS\+::move\+Particle\+Using\+Pressure\+Gradient (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



move particles in correction step 

The position and velocity of each particle are updated as  \[
\mathbf{u}_i^{k+1} = \mathbf{u}_i^* - \frac{1}{\rho^0} \langle\nabla P^{k+1} \rangle_i \Delta t.
\] 

Definition at line \mbox{\hyperlink{mps_8hpp_source_l00454}{454}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00455\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\&\ p\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.type\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6ac2e7db5ac7ab74ea4bb9a7a89d251f3a}{ParticleType::Fluid}})\ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.velocity\ +=\ p.acceleration\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}};}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.position\ +=\ p.acceleration\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}}\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}};}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ p.acceleration.setZero();}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00464\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a2c84df62724f22dd2d3f2379ae0c7238_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_a9c368cb50383581f4eef311bca1c513a}\label{class_m_p_s_a9c368cb50383581f4eef311bca1c513a} 
\index{MPS@{MPS}!calCourant@{calCourant}}
\index{calCourant@{calCourant}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{calCourant()}{calCourant()}}
{\footnotesize\ttfamily void MPS\+::cal\+Courant (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



calculate Courant number 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00468}{468}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a3a67bb2944e7f0ae45e9431b0d7e781f}{courant}}\ =\ 0.0;}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.type\ !=\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6ac2e7db5ac7ab74ea4bb9a7a89d251f3a}{ParticleType::Fluid}})}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ iCourant\ =\ (pi.velocity.norm()\ *\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ae5d62fd011e489241c0bb81cd6129880}{dt}})\ /\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_a4efbd869c69cf91f5a620eb777fce8f7}{particleDistance}};}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_m_p_s_a3a67bb2944e7f0ae45e9431b0d7e781f}{courant}}\ \ \ \ \ \ \ \ \ =\ std::max(\mbox{\hyperlink{class_m_p_s_a3a67bb2944e7f0ae45e9431b0d7e781f}{courant}},\ iCourant);}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_m_p_s_a3a67bb2944e7f0ae45e9431b0d7e781f}{courant}}\ >\ \mbox{\hyperlink{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}{settings}}.\mbox{\hyperlink{struct_settings_ab2f4295ff4eedc87307496f037ae30c1}{cflCondition}})\ \{}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}ERROR:\ Courant\ number\ is\ larger\ than\ CFL\ condition.\ Courant\ =\ "{}}\ <<\ \mbox{\hyperlink{class_m_p_s_a3a67bb2944e7f0ae45e9431b0d7e781f}{courant}}\ <<\ std::endl;}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00482\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_a9c368cb50383581f4eef311bca1c513a_icgraph}
\end{center}
\end{figure}
\Hypertarget{class_m_p_s_aebc09c85dee628318c4b756f5bd5a5fb}\label{class_m_p_s_aebc09c85dee628318c4b756f5bd5a5fb} 
\index{MPS@{MPS}!setNeighbors@{setNeighbors}}
\index{setNeighbors@{setNeighbors}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{setNeighbors()}{setNeighbors()}}
{\footnotesize\ttfamily void MPS\+::set\+Neighbors (\begin{DoxyParamCaption}\item[{const double \&}]{re }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



search neighbors of each particle 


\begin{DoxyParams}{Parameters}
{\em re} & effective radius \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{mps_8hpp_source_l00488}{488}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00489\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ pi\ :\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}})\ \{}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi.type\ ==\ \mbox{\hyperlink{particle_8hpp_aded321cd7610a60bfbc018a66067a3d6a401357e57c765967393ba391a338e89b}{ParticleType::Ghost}})}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ pi.neighbors.clear();}
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ix\ =\ (int)\ ((pi.position.x()\ -\/\ \mbox{\hyperlink{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}{domain}}.\mbox{\hyperlink{class_domain_a7f77b2d54ba8c9d6ec50c1a130ea88df}{xMin}})\ /\ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_a8514c021ccf8da27960093f22eb81abf}{length}})\ +\ 1;}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ iy\ =\ (int)\ ((pi.position.y()\ -\/\ \mbox{\hyperlink{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}{domain}}.\mbox{\hyperlink{class_domain_a9372bc6152311dae4809c961602584fb}{yMin}})\ /\ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_a8514c021ccf8da27960093f22eb81abf}{length}})\ +\ 1;}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ iz\ =\ (int)\ ((pi.position.z()\ -\/\ \mbox{\hyperlink{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}{domain}}.\mbox{\hyperlink{class_domain_a7162dee9e75483dc62248a31a6e1fc55}{zMin}})\ /\ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_a8514c021ccf8da27960093f22eb81abf}{length}})\ +\ 1;}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jx\ =\ ix\ -\/\ 1;\ jx\ <=\ ix\ +\ 1;\ jx++)\ \{}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jy\ =\ iy\ -\/\ 1;\ jy\ <=\ iy\ +\ 1;\ jy++)\ \{}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jz\ =\ iz\ -\/\ 1;\ jz\ <=\ iz\ +\ 1;\ jz++)\ \{}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ jBucket\ =\ jx\ +\ jy\ *\ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_af2a16ef88efa12780d6b5fb1effa029e}{numX}}\ +\ jz\ *\ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_af2a16ef88efa12780d6b5fb1effa029e}{numX}}\ *\ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_a694406021047bc750977908bbb92364a}{numY}};}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ j\ \ \ \ \ \ \ =\ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_ae0bf8c4d7cda66033e46c74d446cb530}{first}}[jBucket];}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (j\ !=\ -\/1)\ \{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_particle}{Particle}}\&\ pj\ =\ \mbox{\hyperlink{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}{particles}}[j];}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dist\ =\ (pj.\mbox{\hyperlink{class_particle_a302f050b0320dcc4b580d08131d8781b}{position}}\ -\/\ pi.position).norm();}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ !=\ pi.id\ \&\&\ dist\ <\ re)\ \{}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pi.neighbors.emplace\_back(j,\ dist);}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j\ =\ \mbox{\hyperlink{class_m_p_s_acf5a5aef898355313e7c574eb248560f}{bucket}}.\mbox{\hyperlink{class_bucket_a63f2db7677b4e97032835f5d03a5e650}{next}}[j];}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00520\ \ \ \ \ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_p_s_aebc09c85dee628318c4b756f5bd5a5fb_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\Hypertarget{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568}\label{class_m_p_s_a2ef53fe62cdefa4c5d031c725ff3d568} 
\index{MPS@{MPS}!settings@{settings}}
\index{settings@{settings}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{settings}{settings}}
{\footnotesize\ttfamily \mbox{\hyperlink{struct_settings}{Settings}} MPS\+::settings}



\doxylink{struct_settings}{Settings} for the simulation. 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00038}{38}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.

\Hypertarget{class_m_p_s_a79c31492815a6099b360e963dafad6f6}\label{class_m_p_s_a79c31492815a6099b360e963dafad6f6} 
\index{MPS@{MPS}!refValues@{refValues}}
\index{refValues@{refValues}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{refValues}{refValues}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_ref_values}{Ref\+Values}} MPS\+::ref\+Values}



Reference values for the simulation ( $n^0$, $\lambda^0$) 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00039}{39}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.

\Hypertarget{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8}\label{class_m_p_s_aaf01fd7eadc5b2471edb9ee1a0b53df8} 
\index{MPS@{MPS}!particles@{particles}}
\index{particles@{particles}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{particles}{particles}}
{\footnotesize\ttfamily vector$<$\mbox{\hyperlink{class_particle}{Particle}}$>$ MPS\+::particles}



Particles in the simulation. 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00040}{40}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.

\Hypertarget{class_m_p_s_acf5a5aef898355313e7c574eb248560f}\label{class_m_p_s_acf5a5aef898355313e7c574eb248560f} 
\index{MPS@{MPS}!bucket@{bucket}}
\index{bucket@{bucket}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{bucket}{bucket}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_bucket}{Bucket}} MPS\+::bucket}



\doxylink{class_bucket}{Bucket} for neighbor search. 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00041}{41}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.

\Hypertarget{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e}\label{class_m_p_s_afa5ce14841858d96878eaded8b7e4b7e} 
\index{MPS@{MPS}!domain@{domain}}
\index{domain@{domain}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{domain}{domain}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_domain}{Domain}} MPS\+::domain}



\doxylink{class_domain}{Domain} of the simulation. 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00042}{42}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.

\Hypertarget{class_m_p_s_a76fc67a6aebaf6a9316ea1c1ad39e454}\label{class_m_p_s_a76fc67a6aebaf6a9316ea1c1ad39e454} 
\index{MPS@{MPS}!coefficientMatrix@{coefficientMatrix}}
\index{coefficientMatrix@{coefficientMatrix}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{coefficientMatrix}{coefficientMatrix}}
{\footnotesize\ttfamily Sparse\+Matrix$<$double, Eigen\+::\+Row\+Major$>$ MPS\+::coefficient\+Matrix}



Coefficient matrix for pressure Poisson equation. 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00045}{45}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.

\Hypertarget{class_m_p_s_abe420b9a8ab12bce1ec40c77eb1fc56e}\label{class_m_p_s_abe420b9a8ab12bce1ec40c77eb1fc56e} 
\index{MPS@{MPS}!sourceTerm@{sourceTerm}}
\index{sourceTerm@{sourceTerm}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{sourceTerm}{sourceTerm}}
{\footnotesize\ttfamily Vector\+Xd MPS\+::source\+Term}



Source term for pressure Poisson equation. 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00046}{46}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.

\Hypertarget{class_m_p_s_ae9ae97d3b9cc79fe5dc88aa1130a31d3}\label{class_m_p_s_ae9ae97d3b9cc79fe5dc88aa1130a31d3} 
\index{MPS@{MPS}!pressure@{pressure}}
\index{pressure@{pressure}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{pressure}{pressure}}
{\footnotesize\ttfamily Vector\+Xd MPS\+::pressure}



Solution of pressure Poisson equation. 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00047}{47}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.

\Hypertarget{class_m_p_s_a3a67bb2944e7f0ae45e9431b0d7e781f}\label{class_m_p_s_a3a67bb2944e7f0ae45e9431b0d7e781f} 
\index{MPS@{MPS}!courant@{courant}}
\index{courant@{courant}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{courant}{courant}}
{\footnotesize\ttfamily double MPS\+::courant}



Maximum courant number among all particles. 



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00049}{49}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.

\Hypertarget{class_m_p_s_a63fc7ef7401815d29f28b82c46e9b138}\label{class_m_p_s_a63fc7ef7401815d29f28b82c46e9b138} 
\index{MPS@{MPS}!logFile@{logFile}}
\index{logFile@{logFile}!MPS@{MPS}}
\doxysubsubsection{\texorpdfstring{logFile}{logFile}}
{\footnotesize\ttfamily FILE\texorpdfstring{$\ast$}{*} MPS\+::log\+File}



Definition at line \mbox{\hyperlink{mps_8hpp_source_l00050}{50}} of file \mbox{\hyperlink{mps_8hpp_source}{mps.\+hpp}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/\mbox{\hyperlink{mps_8hpp}{mps.\+hpp}}\end{DoxyCompactItemize}
